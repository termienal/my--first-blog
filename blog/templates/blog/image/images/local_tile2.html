<html>
<head>
	
    <title>IOGANEWS</title>
	<meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1">
	
	<style>
	body {font-family: Comic sans Ms, sans-serif;}
	* {
		box-sizing: border-box;
		margin-top:0px;
		margin-left:0px;
		margin-right:0px;
		margin-bottom:0px;
		}
		tr { cursor: default; }
.highlight { background: yellow; }
.highlight2 { background: green; }
.highlight3 { background: lightblue; }
		#rcorners1 {
			border-radius: 25px;
			background: #73AD21;
			padding: 0px; 
			width: 25%;
			height: 100%;   
			
		}
		#rcorners3 {
		border-radius: 25px;
		background: url(paper.gif);
		background-position: left top;
		background-repeat: repeat;
		padding: 20px; 
		width: 25%;
		height: 100%;    
}
.center {
    display: block;
    margin-left: auto;
    margin-right: auto;
    width: 50%;
}

		/* Create two unequal columns that floats next to each other */
		.column {
			float: left;
			padding: 0px;
			height: 200px; /* Should be removed. Only for demonstration */
		}
		
		.column2 {
			float: left;
			padding: 0px;
			height: 100%; /* Should be removed. Only for demonstration */
		}

		.left {
		  width: 50%;
		
		  height:200px;
		    background-color: lightblue;
		
		}
		.left1 {
		  width: 40%;
		
		  height:100%;
		    background-color: white;
		
		}
		.bottom {
		  width: 100%;
		  
		    height: 700px;
		}

		.right {
		  width:50%;

		   height: 200px;
	
	
		}
		.right1 {
		  width:60%;

		  
	
	
		}
		table, th{
  border: 1px solid black;
  border-collapse: collapse;
  padding: 2px;
  text-align: center;
}

table, td {
  border: 1px solid black;
  border-collapse: collapse;
  padding: 2px;
  text-align: left;
}
tr:nth-child(even) {
  background: #cccccc;
  font-weight: normal;
}
table tr:hover td {
    background: linear-gradient(to bottom,  #7d7e7d 0%,lightblue 8%,#0e0e0e 100%);;
	font-weight: normal;
}
tr.clicked {
      background: linear-gradient(to bottom,  #7d7e7d 0%,yellow 8%,#0e0e0e 100%);;
	  color:black;
	  font-weight: bold;
}


		/* Clear floats after the columns */
		.row:after {
			content: "";
			display: table;
			clear: both;
		}
		
		.topnav {
  overflow: hidden;
  background-color: green;
    border: 1px solid #ccc;  
	height:50px;
}

.topnav a {
  float: left;
  display: block;
  color: black;
  text-align: center;
  padding: 14px 16px;
  text-decoration: none;
  font-size: 17px;
}

.topnav a:hover {
  background-color: #ddd;
  color: black;
}


.topnav a.active {
  background-color: black;
  color: white;
}

.topnav .search-container {
  float: right;
}

.topnav input[type=date] {
  padding: 6px;
  margin-top: 8px;
  font-size: 17px;
  border: none;
}

.topnav .search-container button {
  float: right;
  padding: 6px;
  margin-top: 8px;
  margin-right: 16px;
  background: #ddd;
  font-size: 17px;
  border: none;
  cursor: pointer;
}

.topnav .search-container button:hover {
  background: #ccc;
}


  .topnav a, .topnav input[type=date], .topnav .search-container button {
    float: none;
    display: block;
    text-align: left;
    width: 100%;
    margin: 0;
    padding: 14px;
  }
  .topnav input[type=date] {
    border: 1px solid black;  
  }
  
	</style>

<body onLoad="init();">
 
    <!-- define a DIV into which the map will appear. Make it take up the whole window -->
	 
<div>
		
					
		<table style="width:100%;font-size:12px;" id="table">
		  
		 
		</table>



	
		
	
			  
						  <div  id="map" style="background-color:#bbb;  	 border-style: solid; border-color: #000000;height:600px ">
						 

						
  </div>    
    


<!--<div  class="bottom">
<div id="plot1" style="width:100%;height:50%; background-color: lightblue;"></div>
<div id="plot2" style="width:100%;height:50%; background-color: lightblue;"></div>
</div>-->


    <link rel="stylesheet" href="style.css" type="text/css" />
    <!-- bring in the OpenLayers javascript library -->
   <script src='leaflet-omnivore.min.js'></script>

		<!--vendor-->

	
		<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
		<link rel="stylesheet" href="leaflet.css" />
		<script src="leaflet.js"></script>
		<link rel="stylesheet" href="leaflet-velocity.css" />
		<script src="leaflet-velocity.js"></script>


	   <script src="tippy.all.min.js"></script>
 
    <script type="text/javascript">
	
		
		
		
		
	function resizeIframe(obj) {
    obj.style.height = obj.contentWindow.document.body.scrollHeight + 'px';
  }
  
  
	tippy('input', { content: "Select the Maximum date in MM/DD/YYYY" })
	var month0=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];

	//document.getElementById("input").value = "02/02/2018";

	

var LeafIcon,LeafIcon2 ;
var greenIcon;
var greenIcon2;
  var lat=-16.4587;
        var lon=46.93;
        var zoom=9;
 
      var mapStuff;
	
			var map;
			var layerControl;
				var layerGroup;
			
						
				

        //Initialise the 'map' object
        function init() {
			
			
			LeafIcon = L.Icon.extend({
								options: {
									shadowUrl: 'bigred.png',
									iconSize:     [30, 30],
									shadowSize:   [2, 2],
									iconAnchor:   [15, 15],
									shadowAnchor: [0, 0],
									popupAnchor:  [0, 0]
								}
							});
			greenIcon = new LeafIcon({iconUrl: 'star2.png'});
			
			LeafIcon2 = L.Icon.extend({
								options: {
									shadowUrl: 'biggreen.png',
									iconSize:     [10, 10],
									shadowSize:   [0, 0],
									iconAnchor:   [5, 5],
									shadowAnchor: [0, 0],
									popupAnchor:  [0, 0]
								}
							});
			greenIcon2 = new LeafIcon2({iconUrl: 'biggreen.png'});
            
				mapStuff = initDemoMap();
			 
										 map = mapStuff.map;
										layerControl = mapStuff.layerControl;
										
										layerGroup = L.layerGroup().addTo(map);
										
										
																	var legend2 = L.control({position: 'bottomright'});

legend2.onAdd = function (map) {

    var div = L.DomUtil.create('div', 'info legend2');
  

    // loop through our density intervals and generate a label with a colored square for each interval
	div.style.backgroundColor ="white";
	div.style.paddingBottom="5px";
	div.style.paddingRight="5px";
	div.style.paddingLeft="5px";
	div.style.paddingTop="5px";
	div.style.border="3 solid #000000";
	
	 div.style.borderRadius="8px";
	 

   
			div.innerHTML +='<img src="lsi_official.gif" style="width:150px;height:90px;"> ';
			

		

		
		


return div;
};

legend2.addTo(map);	
										
			/*$.getJSON("fiv.geojson",function(data){
					
					

				// add GeoJSON layer to the map once the file is loaded
				var datalayer = L.geoJson(data ,{
					
					 
					style: function(feature) {
						switch (feature.properties.CODEFAR) {
							case 1: return {weight: 1,color: "#ff0000",fillOpacity: 0.0};
							case 2:   return {weight: 1,color: "#00ff00",fillOpacity: 0.0};
							case 3:   return {weight: 1,color: "#0000ff",fillOpacity: 0.0};
							case 4:   return {weight: 1,color: "#ff00ff",fillOpacity: 0.0};
							case 5:   return {weight: 1,color: "#00ffff",fillOpacity: 0.0};
							case 7:   return {weight: 1,color: "#000000",fillOpacity: 0.0};
							
							 
						}
					},
				onEachFeature: function(feature, featureLayer) {
				featureLayer.bindPopup('<b>'+feature.properties.NOMREG+'</b></br>'+feature.properties.NOMFIV);
				}
				})
				layerControl.addOverlay(datalayer, "Fivondronana");
				});
				
				
				$.getJSON("geol.geojson",function(data){
					
					

				// add GeoJSON layer to the map once the file is loaded
				var datalayer = L.geoJson(data ,{
					
					 
					style: function(feature) {
						switch (feature.properties.TYPE) {
							case 1: return {weight: 1,color: "#ff0000",fillOpacity: 0.0};
							case 2:   return {weight: 1,color: "#00ff00",fillOpacity: 0.0};
							case 3:   return {weight: 1,color: "#0000ff",fillOpacity: 0.0};
							case 4:   return {weight: 1,color: "#ff00ff",fillOpacity: 0.0};
							case 5:   return {weight: 1,color: "#00ffff",fillOpacity: 0.0};
							case 7:   return {weight: 1,color: "#000000",fillOpacity: 0.0};
							case 8:   return {weight: 1,color: "#ffff00",fillOpacity: 0.0};
							case 9:   return {weight: 1,color: "#f0000f",fillOpacity: 0.0};
							case 10:   return {weight: 1,color: "#00f0f0",fillOpacity: 0.0};
							case 11:   return {weight: 1,color: "#f0f000",fillOpacity: 0.0};
							
							 
						}
					},
				onEachFeature: function(feature, featureLayer) {
				featureLayer.bindPopup(feature.properties.RECLASS_NA);
				}
				})
				layerControl.addOverlay(datalayer, "Geology");
				});
				
				
					$.getJSON("fault.geojson",function(data){
					
					

				// add GeoJSON layer to the map once the file is loaded
				var datalayer = L.geoJson(data ,{
					
					 
					style: function(feature) {
						switch (feature.properties.TYPE) {
							case 'thrust-fault': return {weight: 2,color: "#ff0000",fillOpacity: 0.0};
							case 'tectonic contact':   return {weight: 2,color: "#00ff00",fillOpacity: 0.0};
							case 'step':   return {weight: 2,color: "#0000ff",fillOpacity: 0.0};
							case 'rift':   return {weight: 2,color: "#ff00ff",fillOpacity: 0.0};
							
							
							 
						}
					},
				onEachFeature: function(feature, featureLayer) {
				featureLayer.bindPopup(feature.properties.TYPE);
				}
				})
				layerControl.addOverlay(datalayer, "Faults");
				});
				
				
				
							$.getJSON("cities.geojson",function(data){
					
					

				// add GeoJSON layer to the map once the file is loaded
				var datalayer = L.geoJson(data ,{
					
				
				onEachFeature: function(feature, featureLayer) {
				featureLayer.bindPopup(feature.properties.NAME);
				}
				})
				layerControl.addOverlay(datalayer, "Cities");
				});
					
					
					
				
				
					$.getJSON("plates.geojson",function(data){
					
					

				// add GeoJSON layer to the map once the file is loaded
				var datalayer = L.geoJson(data ,{
					
					 
					style: function(feature) {
						switch (feature.properties.NAME) {
							case 'African Plate': return {weight: 2,color: "#ff0000",fillOpacity: 0.0};
							case 'Amur Plate':   return {weight: 2,color: "#00ff00",fillOpacity: 0.0};
							case 'Antarctic Plate':   return {weight: 2,color: "#0000ff",fillOpacity: 0.0};
							case 'Arabian Plate':   return {weight: 2,color: "#ff00ff",fillOpacity: 0.0};
							case 'Caribbean Plate':   return {weight: 2,color: "#ff00ff",fillOpacity: 0.0};
							case 'Coca Plate':   return {weight: 2,color: "#ff00ff",fillOpacity: 0.0};
							case 'Eurasian Plate':   return {weight: 2,color: "#ff00ff",fillOpacity: 0.0};
							case 'Indo-Chinese Plate':   return {weight: 2,color: "#ff00f0",fillOpacity: 0.0};
							case 'Nasca Plate':   return {weight: 2,color: "#0f000f",fillOpacity: 0.0};
							case 'North American Plate':   return {weight: 2,color: "#f000ff",fillOpacity: 0.0};
							case 'Okhotsk Plate':   return {weight: 2,color: "#ff000f",fillOpacity: 0.0};
							case 'Pacific Plate':   return {weight: 2,color: "#0000f0",fillOpacity: 0.0};
							case 'Philippine Plate':   return {weight: 2,color: "#00000f",fillOpacity: 0.0};
							case 'Somali Plate':   return {weight: 2,color: "#ff0011",fillOpacity: 0.0};
							case 'South American Plate':   return {weight: 2,color: "#1100ff",fillOpacity: 0.0};
							case 'rift':   return {weight: 2,color: "#ff0088",fillOpacity: 0.0};
							case 'rift':   return {weight: 2,color: "#8800ff",fillOpacity: 0.0};
							
							
							 
						}
					},
				onEachFeature: function(feature, featureLayer) {
				featureLayer.bindPopup(feature.properties.NAME);
				}
				})
				layerControl.addOverlay(datalayer, "Plate");
				});*/
										
			getEventList();
        }
			var str="";
			
			
function getEventList(){
					
					
					layerGroup.clearLayers();
					layerControl.removeLayer(layerGroup);
	
	
				str="<tr>\n    <th>ORID</th>\n    <th>TEMPS D'ORIGINE</th>\n    <th>LAT</th>\n	<th>LON</th>\n	<th>MAG</th>\n	<th>PROFONDEUR</th>\n	<th>LIEU</th>\n<th>STATUT</th>\n";
		
				<!--var inputId = document.getElementById("HospitalId").value; //we get the user input value and put it in a var

//////////////////////////////////////////////////////////////////////////////////////////////
				var xhttp = new XMLHttpRequest();
				<!--xhttp.open("GET", "path/to/yourPhpFile.php?hId=" + inputId, true); // we're passing the hId to the server as a parameter
				
				xhttp.onreadystatechange = function() 
				{
					if (xhttp.readyState == 4 && xhttp.status == 200) {
					
						var res= this.responseText.split("---");
						//alert(res.length);
						
						var i=0;
						for(i=0;i<res.length;i++)
						{
						
								var res2= res[i].split("***");
								//alert(res2.length);
								
								if(res2.length==8)
								{
						
										
								
								
							var str0='<b style="font-size:10pt;">Lieu:</b> <span>'+res2[6]+'</span>\n<br>';
							str0+='<b style="font-size:10pt;">Origin Time:</b> <span>'+res2[5]+' UTC</span>\n<br>';
							str0+='<b style="font-size:10pt;">Lat:</b> <span>'+res2[1]+'</span>\n<br>';
							str0+='<b style="font-size:10pt;">Lon:</b> <span>'+res2[2]+'</span>\n<br>';
							
								
								
								
					//	document.getElementById("origin").innerHTML=""+d.getDate() + "/" +m + "/" +d.getFullYear() + " " +d.getHours() + ":" +d.getMinutes() + ":" +d.getSeconds()+ "." +d.getMilliseconds();
						
					//	document.getElementById("lat").innerHTML =res2[2];
						//document.getElementById("lon").innerHTML =res2[3];
						
					
									
						
							
						/*var ma="";
						if(parseFloat(res2[5])>0)
							ma =ma+"Ml:"+res2[5]+" ";
						if(parseFloat(res2[4])>0)
							ma =ma+"Mc:"+res2[4]+" ";
						if(parseFloat(res2[6])>0)
							ma =ma+"Mb:"+res2[6];
							
							document.getElementById("mag").innerHTML=ma;*/
							
							str0+='<b style="font-size:10pt;">Mag:</b> <span>'+res2[3]+'</span>\n<br>';
str0+='<img src="lsi_official.gif" style="width:150px;height:90px;"> ';

							
						//if(res[7]=="M")
							//document.getElementById("status").innerHTML="Manual";
							//else document.getElementById("status").innerHTML="Automatic";
							
							
							var marker;
							marker=L.marker([parseFloat(res2[1]),parseFloat(res2[2])], {icon: greenIcon,myCustomId: i}).addTo(map).bindPopup(str0, { autoClose: false});
									
						//marker=L.marker([parseFloat(res2[1]),parseFloat(res2[2])]).addTo(map).bindPopup(str0, { autoClose: false}).openPopup();
							map.panTo(marker.getLatLng());
						
							/*
							marker.on('mouseover', function(e){
										e.target.openPopup();
										});*/
										 marker.on('click', function (e){
							
											var rows = $('tr').not(':first');
											rows.removeClass('clicked');
											//var row=document.getElementById("table").getElementById(''+layerGroup.getLayerId(marker));
											//row.toggleClass('clicked');
											//	row.toggleClass("clicked");
											$('tr').eq(this.options.myCustomId+1).toggleClass("clicked");
											//alert(this.options.myCustomId)
													
													e.target.openPopup();
										});
										layerGroup.addLayer(marker);
										map.panTo(marker.getLatLng());
										
							str+='<tr id="'+layerGroup.getLayerId(marker)+'"name="'+layerGroup.getLayerId(marker)+'">\n<td>'+res2[0]+"</td>\n<td>"+res2[5]+" UTC</td>\n<td>"+res2[1]+"°</td>\n<td>"+res2[2]+"°</td>\n<td>"+res2[3]+"</td>\n<td>"+res2[4]+"Km</td>\n<td>"+res2[6]+"</td>\n<td>"+res2[7]+"</td>\n</tr>\n";
							
										
							if(i==0)
							{
						
						marker.options.icon=greenIcon2;
											marker.openPopup();
										
											//document.getElementById("page3").src="local_tiles.html?orid="+res2[0];
												
												//updateMap(res2,""+d.getDate() + "/" +m + "/" +d.getFullYear() + " " +d.getHours() + ":" +d.getMinutes() + ":" +d.getSeconds()+ "." +d.getMilliseconds());
				
							}if(i==res.length-2)
										{
										
											layerControl.addOverlay(layerGroup,"Events");
										document.getElementById("table").innerHTML=str+"\n</tr>";
										
										//tippy('teddy', { content: "Select the Maximum date in MM/DD/YYYY" })
											
										$(function() {

												/* Get all rows from your 'table' but not the first one 
												 * that includes headers. */
												var rows = $('tr').not(':first');
												$('tr').eq(0).addClass('highlight2');
												
												if(i>1)
												{
												//$('tr').eq(1).addClass('highlight');
												$('tr').eq(1).toggleClass("clicked");
												
												}

												/* Create 'click' event handler for rows */
												
												rows.on('click', function(e) {

													/* Get current row */
													var row = $(this);

													/* Check if 'Ctrl', 'cmd' or 'Shift' keyboard key was pressed
													 * 'Ctrl' => is represented by 'e.ctrlKey' or 'e.metaKey'
													 * 'Shift' => is represented by 'e.shiftKey' */
													/*if ((e.ctrlKey || e.metaKey) || e.shiftKey) {
														//If pressed highlight the other row that was clicked 
														row.addClass('highlight');
													} else {*/
														/* Otherwise just highlight one row and clean others */
														
														//rows.addClass('highlight').siblings().removeClass('highlight');
														rows.removeClass('clicked');
														//row.addClass('highlight');
														row.toggleClass("clicked");
														layerGroup.eachLayer(function (layer){
															layer.closePopup();
															
														})
														var marker=layerGroup.getLayer(row.attr("name"));
														marker.openPopup();
														//alert(row.attr("name"))
														map.panTo(marker.getLatLng());
														
														//alert(marker.options.myCustomId)
														
														
													
													var tableHeadings = row.map(function() {
														return $(this).text();
													}).get();
													
													
											
													// document.getElementById("page3").src="local_tiles.html?orid="+all[1];
												
													//updateMap(res4,all[2]);
											
													//}

												});

												/* This 'event' is used just to avoid that the table text 
												 * gets selected (just for styling). 
												 * For example, when pressing 'Shift' keyboard key and clicking 
												 * (without this 'event') the text of the 'table' will be selected.
												 * You can remove it if you want, I just tested this in 
												 * Chrome v30.0.1599.69 */
												$(document).bind('selectstart dragstart', function(e) { 
													e.preventDefault(); return false; 
												});

											});
	
												//alert(str)
										}

									}
												
												
												
						}
					}
				};
				xhttp.open("GET", "getevents.php", true); // we're passing the hId to the server as a parameter
				
				xhttp.send();
				

		
			
			
			
			//////////////////////////////////////////////////////////////////////////////////////////
			
			
			//////////////////////////////////////////////////////////////////////////////////////////////
				
				

			
				
				
				};
			
	function initDemoMap(){

  
			
				
			
				 var Esri_WorldImagery = L.tileLayer('http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
						attribution: 'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, ' +
						'AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community'
					});
			
				
				
				var OpenStreetMap = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
					attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
					maxZoom: 19,
					minZoom: 1
				});
				
				var OpenTopoMap = L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png', {
	maxZoom: 17,
					minZoom: 1,
	attribution: 'Map data: &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, <a href="http://viewfinderpanoramas.org">SRTM</a> | Map style: &copy; <a href="https://opentopomap.org">OpenTopoMap</a> (<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>)'
});
				
				
		var CartoDB_DarkMatter = L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
	attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
	subdomains: 'abcd',
	maxZoom: 19,
					minZoom: 1
});

var Esri_NatGeoWorldMap = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/{z}/{y}/{x}', {
	attribution: 'Tiles &copy; Esri &mdash; National Geographic, Esri, DeLorme, NAVTEQ, UNEP-WCMC, USGS, NASA, ESA, METI, NRCAN, GEBCO, NOAA, iPC',
	maxZoom: 16,
					minZoom: 1
});
var Stamen_Watercolor = L.tileLayer('https://stamen-tiles-{s}.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.{ext}', {
	attribution: 'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
	subdomains: 'abcd',
	minZoom: 1,
	maxZoom: 16,
	ext: 'jpg'
});

				
				
				var baseLayers = {
				 
					 "ESRI Satellite":Esri_WorldImagery,
					 "OpenTopoMap":OpenTopoMap,
					 "DarkMatter":CartoDB_DarkMatter,
					 "ESRI NatGeoWorldMap":Esri_NatGeoWorldMap,
					 "Stamen Watercolor":Stamen_Watercolor,
					 "OpenStreetMap": OpenStreetMap
				};

				var map = L.map('map', {
					layers: [ OpenStreetMap ]
				});

				var layerControl = L.control.layers(baseLayers);
				layerControl.addTo(map);
				map.setView([-19, 47], 7);

				return {
					map: map,
					layerControl: layerControl
				};
}
			
		
 
    </script>
</head>
 
<!-- body.onload is called once the page is loaded (call the 'init' function) -->


</body>
<!--<p><script>openNav();</script></p>-->
 
</html>
